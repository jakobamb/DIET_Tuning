WandB initialized: DIET_dinov2_small_cifar10_20250419_162230

==================================================
INITIAL ZERO-SHOT EVALUATION (BEFORE TRAINING)
==================================================
Extracting features for zero-shot evaluation...
Extracting features:   0%|          | 0/500 [00:00<?, ?it/s]
Feature hash: 2475278131088327274 (should change between evaluations)
Features extracted: (10000, 384), time: 20.62s
Running k-NN evaluation...
k-NN accuracy: 0.9414, time: 0.44s
Running k-means clustering evaluation...
k-means ARI: 0.6247, NMI: 0.7445, time: 1.20s
Running linear probe evaluation...
Linear probe accuracy: 0.9234, time: 0.08s
Total zero-shot evaluation time: 22.35s
Initial evaluation completed in 22.35s

==========================
Starting epoch 1/1 at 16:22:53
==========================

Initializing training loop...


Batch 0: grad_norm=101.1777 across 22310154 trainable params
Batch 10: grad_norm=9.6577 across 22310154 trainable params
Batch 20: grad_norm=8.2211 across 22310154 trainable params
Batch 30: grad_norm=4.4160 across 22310154 trainable params
Batch 40: grad_norm=5.4789 across 22310154 trainable params

Epoch 1 completed in 7.47s

Learning rate updated to: 0.000010
Epoch 1 Metrics - DIET Loss: 2.3073e+00, Probe Loss: 3.2331e+00, Accuracy: 0.1120

Starting evaluation on test set:
Test Batch 0: Accuracy=0.1000
Test Batch 10: Accuracy=0.2000
Test Batch 20: Accuracy=0.2500
Test Batch 30: Accuracy=0.0000
Test Batch 40: Accuracy=0.3500
Test Batch 50: Accuracy=0.0500
Test Batch 60: Accuracy=0.1500
Test Batch 70: Accuracy=0.1000
Test Batch 80: Accuracy=0.2000
Test Batch 90: Accuracy=0.0500
Test Batch 100: Accuracy=0.2500
Test Batch 110: Accuracy=0.2500
Test Batch 120: Accuracy=0.1000
Test Batch 130: Accuracy=0.1500
Test Batch 140: Accuracy=0.1000
Test Batch 150: Accuracy=0.1000
Test Batch 160: Accuracy=0.1000
Test Batch 170: Accuracy=0.1500
Test Batch 180: Accuracy=0.0000
Test Batch 190: Accuracy=0.1500
Test Batch 200: Accuracy=0.1500
Test Batch 210: Accuracy=0.0500
Test Batch 220: Accuracy=0.0500
Test Batch 230: Accuracy=0.1500
Test Batch 240: Accuracy=0.0500
Test Batch 250: Accuracy=0.3000
Test Batch 260: Accuracy=0.1500
Test Batch 270: Accuracy=0.1500
Test Batch 280: Accuracy=0.1000
Test Batch 290: Accuracy=0.1500
Test Batch 300: Accuracy=0.1000
Test Batch 310: Accuracy=0.1500
Test Batch 320: Accuracy=0.1000
Test Batch 330: Accuracy=0.2000
Test Batch 340: Accuracy=0.1000
Test Batch 350: Accuracy=0.1500
Test Batch 360: Accuracy=0.0500
Test Batch 370: Accuracy=0.1000
Test Batch 380: Accuracy=0.1500
Test Batch 390: Accuracy=0.0500
Test Batch 400: Accuracy=0.0500
Test Batch 410: Accuracy=0.1000
Test Batch 420: Accuracy=0.0500
Test Batch 430: Accuracy=0.0500
Test Batch 440: Accuracy=0.0500
Test Batch 450: Accuracy=0.1500
Test Batch 460: Accuracy=0.1000
Test Batch 470: Accuracy=0.1000
Test Batch 480: Accuracy=0.0500
Test Batch 490: Accuracy=0.0000

Overall Test Accuracy: 0.1144
Epoch 1/1 summary:
  Train - DIET loss: 2.3073e+00, Probe loss: 3.2331e+00, Acc: 0.1120
  Test  - Acc: 0.1144

Running zero-shot evaluation at epoch 1...
Extracting features for zero-shot evaluation...
Extracting features:   0%|          | 0/500 [00:00<?, ?it/s]
Feature hash: -6690187138116253422 (should change between evaluations)
Features extracted: (10000, 384), time: 20.73s
Running k-NN evaluation...
k-NN accuracy: 0.3883, time: 0.31s
Running k-means clustering evaluation...
k-means ARI: 0.0327, NMI: 0.0695, time: 1.46s
Running linear probe evaluation...
Linear probe accuracy: 0.1710, time: 0.04s
Total zero-shot evaluation time: 22.54s

Training completed in 52.97s

==================================================
FINAL ZERO-SHOT EVALUATION (AFTER TRAINING)
==================================================
Extracting features for zero-shot evaluation...
Extracting features:   0%|          | 0/500 [00:00<?, ?it/s]
Feature hash: -6690187138116253422 (should change between evaluations)
Features extracted: (10000, 384), time: 20.64s
Running k-NN evaluation...
k-NN accuracy: 0.3883, time: 0.32s
Running k-means clustering evaluation...
k-means ARI: 0.0327, NMI: 0.0695, time: 1.46s
Running linear probe evaluation...
Linear probe accuracy: 0.1440, time: 0.04s
Total zero-shot evaluation time: 22.46s
Final evaluation completed in 22.46s

==================================================
EXPERIMENT RESULTS SUMMARY
==================================================
Number of classes: 10
DIET label smoothing: 0.3 (DIET active)

Zero-shot performance:
------------------------------------------------------------
Metric          Initial    Final      Improvement Relative %
------------------------------------------------------------
knn_acc         0.9414     0.3883     -0.5531     -58.75%
kmeans_ari      0.6247     0.0327     -0.5920     -94.76%
kmeans_nmi      0.7445     0.0695     -0.6750     -90.66%
linear_acc      0.9234     0.1440     -0.7794     -84.41%

CONCLUSION:
DIET finetuning did not improve zero-shot performance
Failed to create report table - continuing without it
