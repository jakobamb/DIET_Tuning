WandB initialized: DIET_dinov2_small_cifar10_20250419_160218

==================================================
INITIAL ZERO-SHOT EVALUATION (BEFORE TRAINING)
==================================================
Extracting features for zero-shot evaluation...
Extracting features:   0%|          | 0/500 [00:00<?, ?it/s]
Feature hash: 4571484474204031955 (should change between evaluations)
Features extracted: (10000, 384), time: 20.81s
Running k-NN evaluation...
k-NN accuracy: 0.9414, time: 0.45s
Running k-means clustering evaluation...
k-means ARI: 0.6247, NMI: 0.7445, time: 1.23s
Running linear probe evaluation...
Linear probe accuracy: 0.9210, time: 0.08s
Total zero-shot evaluation time: 22.58s
Initial evaluation completed in 22.58s

==========================
Starting epoch 1/30 at 16:02:44
==========================

Initializing training loop...


Batch 0: grad_norm=116.4144 across 22310154 trainable params
Batch 10: grad_norm=8.9160 across 22310154 trainable params
Batch 20: grad_norm=3.8659 across 22310154 trainable params
Batch 30: grad_norm=5.8544 across 22310154 trainable params
Batch 40: grad_norm=4.7331 across 22310154 trainable params

Epoch 1 completed in 7.61s

Learning rate updated to: 0.000499
Epoch 1 Metrics - DIET Loss: 2.3048e+00, Probe Loss: 2.9028e+00, Accuracy: 0.1060

Starting evaluation on test set:
Test Batch 0: Accuracy=0.0000
Test Batch 10: Accuracy=0.0500
Test Batch 20: Accuracy=0.0500
Test Batch 30: Accuracy=0.0500
Test Batch 40: Accuracy=0.2000
Test Batch 50: Accuracy=0.1000
Test Batch 60: Accuracy=0.1000
Test Batch 70: Accuracy=0.0500
Test Batch 80: Accuracy=0.2000
Test Batch 90: Accuracy=0.1000
Test Batch 100: Accuracy=0.1000
Test Batch 110: Accuracy=0.2500
Test Batch 120: Accuracy=0.2500
Test Batch 130: Accuracy=0.1500
Test Batch 140: Accuracy=0.1500
Test Batch 150: Accuracy=0.1000
Test Batch 160: Accuracy=0.1000
Test Batch 170: Accuracy=0.1500
Test Batch 180: Accuracy=0.1500
Test Batch 190: Accuracy=0.0500
Test Batch 200: Accuracy=0.0500
Test Batch 210: Accuracy=0.3000
Test Batch 220: Accuracy=0.1000
Test Batch 230: Accuracy=0.2000
Test Batch 240: Accuracy=0.0000
Test Batch 250: Accuracy=0.2000
Test Batch 260: Accuracy=0.0500
Test Batch 270: Accuracy=0.2500
Test Batch 280: Accuracy=0.0500
Test Batch 290: Accuracy=0.1000
Test Batch 300: Accuracy=0.1500
Test Batch 310: Accuracy=0.1000
Test Batch 320: Accuracy=0.1000
Test Batch 330: Accuracy=0.1500
Test Batch 340: Accuracy=0.0500
Test Batch 350: Accuracy=0.0000
Test Batch 360: Accuracy=0.1500
Test Batch 370: Accuracy=0.1500
Test Batch 380: Accuracy=0.0500
Test Batch 390: Accuracy=0.1000
Test Batch 400: Accuracy=0.1000
Test Batch 410: Accuracy=0.0000
Test Batch 420: Accuracy=0.0000
Test Batch 430: Accuracy=0.0500
Test Batch 440: Accuracy=0.1000
Test Batch 450: Accuracy=0.0000
Test Batch 460: Accuracy=0.0500
Test Batch 470: Accuracy=0.0500
Test Batch 480: Accuracy=0.1500
Test Batch 490: Accuracy=0.0000

Overall Test Accuracy: 0.1009
Epoch 1/30 summary:
  Train - DIET loss: 2.3048e+00, Probe loss: 2.9028e+00, Acc: 0.1060
  Test  - Acc: 0.1009

==========================
Starting epoch 2/30 at 16:03:15
==========================

Initializing training loop...


Batch 0: grad_norm=5.0827 across 22310154 trainable params
Batch 10: grad_norm=3.9745 across 22310154 trainable params
Batch 20: grad_norm=5.0575 across 22310154 trainable params
Batch 30: grad_norm=3.2563 across 22310154 trainable params
Batch 40: grad_norm=5.1491 across 22310154 trainable params

Epoch 2 completed in 7.46s

Learning rate updated to: 0.000495
Epoch 2 Metrics - DIET Loss: 2.3024e+00, Probe Loss: 2.3834e+00, Accuracy: 0.1220

Starting evaluation on test set:
Test Batch 0: Accuracy=0.2500
Test Batch 10: Accuracy=0.1500
Test Batch 20: Accuracy=0.1500
Test Batch 30: Accuracy=0.1000
Test Batch 40: Accuracy=0.1000
Test Batch 50: Accuracy=0.1500
Test Batch 60: Accuracy=0.3000
Test Batch 70: Accuracy=0.1500
Test Batch 80: Accuracy=0.1500
Test Batch 90: Accuracy=0.2500
Test Batch 100: Accuracy=0.1000
Test Batch 110: Accuracy=0.1000
Test Batch 120: Accuracy=0.1500
Test Batch 130: Accuracy=0.1000
Test Batch 140: Accuracy=0.1000
Test Batch 150: Accuracy=0.0000
Test Batch 160: Accuracy=0.1500
Test Batch 170: Accuracy=0.1000
Test Batch 180: Accuracy=0.0500
Test Batch 190: Accuracy=0.1500
Test Batch 200: Accuracy=0.2000
Test Batch 210: Accuracy=0.1000
Test Batch 220: Accuracy=0.1500
Test Batch 230: Accuracy=0.0500
Test Batch 240: Accuracy=0.2000
Test Batch 250: Accuracy=0.0500
Test Batch 260: Accuracy=0.1000
Test Batch 270: Accuracy=0.0500
Test Batch 280: Accuracy=0.1500
Test Batch 290: Accuracy=0.0500
Test Batch 300: Accuracy=0.1000
Test Batch 310: Accuracy=0.2000
Test Batch 320: Accuracy=0.2000
Test Batch 330: Accuracy=0.2000
Test Batch 340: Accuracy=0.1000
Test Batch 350: Accuracy=0.0500
Test Batch 360: Accuracy=0.0500
Test Batch 370: Accuracy=0.3000
Test Batch 380: Accuracy=0.1500
Test Batch 390: Accuracy=0.2000
Test Batch 400: Accuracy=0.2000
Test Batch 410: Accuracy=0.1000
Test Batch 420: Accuracy=0.1500
Test Batch 430: Accuracy=0.2500
Test Batch 440: Accuracy=0.1500
Test Batch 450: Accuracy=0.1500
Test Batch 460: Accuracy=0.3000
Test Batch 470: Accuracy=0.2500
Test Batch 480: Accuracy=0.2500
Test Batch 490: Accuracy=0.1500

Overall Test Accuracy: 0.1402
Epoch 2/30 summary:
  Train - DIET loss: 2.3024e+00, Probe loss: 2.3834e+00, Acc: 0.1220
  Test  - Acc: 0.1402

==========================
Starting epoch 3/30 at 16:03:47
==========================

Initializing training loop...


Batch 0: grad_norm=3.8268 across 22310154 trainable params
Batch 10: grad_norm=4.5237 across 22310154 trainable params
Batch 20: grad_norm=5.1613 across 22310154 trainable params
Batch 30: grad_norm=4.9745 across 22310154 trainable params
Batch 40: grad_norm=3.1622 across 22310154 trainable params
Traceback (most recent call last):
  File "C:\Users\Bryan\Desktop\ResearchAI\main.py", line 291, in <module>
    main()
  File "C:\Users\Bryan\Desktop\ResearchAI\main.py", line 288, in main
    train(args)
  File "C:\Users\Bryan\Desktop\ResearchAI\main.py", line 209, in train
    metrics_history, initial_results, final_results = trainer.train(
                                                      ^^^^^^^^^^^^^^
  File "C:\Users\Bryan\Desktop\ResearchAI\training\trainer.py", line 200, in train
    total_grad_norm += param_norm.item() ** 2
                       ^^^^^^^^^^^^^^^^^
KeyboardInterrupt
